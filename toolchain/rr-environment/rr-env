#!/bin/bash

_arch=$1

if [ -z "${_arch}" ]; then
    _arch=x86_64
fi

if [ -z "${RETROROOT_HOME}" ]; then
    export RETROROOT_HOME=/opt/retroroot
fi

# sysroot path
export RETROROOT_SYSROOT=${RETROROOT_HOME}/target/${_arch}/usr

# toolchain setup
export RETROROOT_TOOLCHAIN=/usr
export RETROROOT_CROSS_PREFIX=$RETROROOT_TOOLCHAIN/bin
export RETROROOT_TOOLS_COMPILER_PREFIX=${RETROROOT_CROSS_PREFIX}/${_arch}-linux-gnu-

export RETROROOT_CC=${RETROROOT_TOOLS_COMPILER_PREFIX}gcc
export RETROROOT_CXX=${RETROROOT_TOOLS_COMPILER_PREFIX}g++
export RETROROOT_LD=${RETROROOT_TOOLS_COMPILER_PREFIX}ld
export RETROROOT_AR=${RETROROOT_TOOLS_COMPILER_PREFIX}ar
export RETROROOT_AS=${RETROROOT_TOOLS_COMPILER_PREFIX}as
export RETROROOT_NM=${RETROROOT_TOOLS_COMPILER_PREFIX}nm
export RETROROOT_RANLIB=${RETROROOT_TOOLS_COMPILER_PREFIX}ranlib
export RETROROOT_STRIP=${RETROROOT_TOOLS_COMPILER_PREFIX}strip
export RETROROOT_PKGCONFIG=${RETROROOT_TOOLS_COMPILER_PREFIX}pkg-config

export CC="${RETROROOT_CC} --sysroot=${RETROROOT_SYSROOT}"
export CXX="${RETROROOT_CXX} --sysroot=${RETROROOT_SYSROOT}"
export LD="${RETROROOT_LD} --sysroot=${RETROROOT_SYSROOT}"
export AR="${RETROROOT_AR} --sysroot=${RETROROOT_SYSROOT}"
export AS="${RETROROOT_AS} --sysroot=${RETROROOT_SYSROOT}"
export NM="${RETROROOT_NM} --sysroot=${RETROROOT_SYSROOT}"
export RANLIB="${RETROROOT_RANLIB} --sysroot=${RETROROOT_SYSROOT}"
export STRIP="${RETROROOT_STRIP} --sysroot=${RETROROOT_SYSROOT}"
export CFLAGS="-isysroot ${RETROROOT_SYSROOT} -I${RETROROOT_SYSROOT}/include -O2 -fexceptions ${CFLAGS}"
export CPPFLAGS="${RETROROOT_CFLAGS} ${CPPFLAGS}"
export CXXFLAGS="${RETROROOT_CFLAGS} ${CXXFLAGS}"
export LDFLAGS="-L${RETROROOT_SYSROOT}/lib -Wl,-O1,--sort-common,--as-needed ${LDFLAGS}"

# pkg config setup
export PKG_CONFIG_DIR=
export PKG_CONFIG_SYSROOT_DIR=${RETROROOT_SYSROOT}
export PKG_CONFIG_LIBDIR=${RETROROOT_SYSROOT}/lib/pkgconfig:${RETROROOT_SYSROOT}/share/pkgconfig
export PKG_CONFIG_PATH=${PKG_CONFIG_PATH_CUSTOM}:${PKG_CONFIG_LIBDIR}

# prefix setup
export RETROROOT_PREFIX=/usr
export RETROROOT_PREFIX_BIN=${RETROROOT_PREFIX}/bin
export RETROROOT_PREFIX_INCLUDE=${RETROROOT_PREFIX}/include
export RETROROOT_PREFIX_LIB=${RETROROOT_PREFIX}/lib
export RETROROOT_PREFIX_ETC=${RETROROOT_PREFIX}/etc
export RETROROOT_PREFIX_SHARE=${RETROROOT_PREFIX}/share

export PATH="${RETROROOT_HOME}:${RETROROOT_SYSROOT}/bin:$PATH"

